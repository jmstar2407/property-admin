<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meetransportation - Env√≠os de USA a Rep√∫blica Dominicana</title>
    <!-- Firebase SDK -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.2/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.2/firebase-firestore-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.2/firebase-auth-compat.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">

    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #5cc528;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: system-ui;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f9f9f9;
        }

        header {
            background-color: var(--primary);
            color: white;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            text-decoration: none;
        }

        .logo span {
            color: var(--secondary);
        }

        nav ul {
            display: flex;
            list-style: none;
            align-items: center;
        }

        nav ul li {
            margin-left: 2rem;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav ul li a:hover {
            color: var(--secondary);
        }

        .hero {
            background: linear-gradient(rgba(44, 62, 80, 0.8), rgba(44, 62, 80, 0.8)), url('./img/background_1.jpg');
            background-size: cover;
            background-position: center;
            height: 100vh;
            display: flex;
            align-items: center;
            text-align: center;
            color: white;
            padding-top: 80px;
        }

        .hero-content h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero-content p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .btn {
            display: inline-block;
            background-color: var(--secondary);
            color: white;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn:hover {
            background-color: #427d26;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .btn-outline {
            background-color: #ffffff1c;
            border: 2px solid white;
            margin-left: 1rem;
            backdrop-filter: blur(10px);
        }

        .btn-outline:hover {
            background-color: #4aff803b;
        }

        #loginBtn {
            background: #5b6779;
            padding: 4px 10px;
            border-radius: 8px;
        }

        #logoutBtn {
            background: #5b6779;
            padding: 4px 10px;
            border-radius: 8px;
        }

        section {
            padding: 3rem 0;
            background: #d9dfe5;
        }

        .section-title {
            text-align: center;
            margin-bottom: 2rem;
        }

        .section-title h2 {
            font-size: 2.5rem;
            color: var(--primary);
            position: relative;
            display: inline-block;
            padding-bottom: 1rem;
        }

        /* Services Section */

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: #2d3436;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .service-card {
            background: linear-gradient(135deg, #fff, #f8f9fa);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .service-icon {
            display: inline-flex;
            width: 100%;
            justify-content: center;
        }

        .service-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #2d3436;
            text-align: center;
        }

        .service-price {
            font-size: 2rem;
            font-weight: bold;
            color: #e17055;
            margin-bottom: 1rem;
            text-align: center;
        }

        .service-details {
            list-style: none;
        }

        .service-details li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e9ecef;
        }

        .service-details li:last-child {
            border-bottom: none;
        }

        .offer-card {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            text-align: center;
        }

        .offer-card {
            background: #2c3e50;
            color: #ffffff;
            text-align: center;
            border: 1px solid #bdbdbd;
        }

        .offer-card .service-title {
            color: #FFC107;
        }

        .quote {
            background: linear-gradient(rgb(44 62 80 / 30%), rgb(44 62 80 / 60%)), url(./img/background_1.jpg);
        }

        .quote-form {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        .package-type {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .package-option {
            flex: 1;
            min-width: 120px;
        }

        .package-option input {
            display: none;
        }

        .package-option label {
            display: block;
            padding: 1rem 5px;
            background-color: var(--light);
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .package-option input:checked+label {
            background-color: var(--secondary);
            color: white;
        }

        .custom-package {
            display: none;
            margin-top: 1.5rem;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .show {
            display: block;
        }

        .additional-items {
            margin-top: 1.5rem;
        }

        .checkbox-group {
            margin-bottom: 1rem;
        }

        .checkbox-group input {
            margin-right: 0.5rem;
        }

        footer {
            background-color: var(--primary);
            color: white;
            padding: 3rem 0 1rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-column h3 {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 0.5rem;
        }

        .footer-column h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 2px;
            background-color: var(--secondary);
        }

        .footer-column p,
        .footer-column a {
            margin-bottom: 1rem;
            display: block;
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-column a:hover {
            color: var(--secondary);
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transition: all 0.3s;
        }

        .social-links a:hover {
            background-color: var(--secondary);
            transform: translateY(-3px);
        }

        .copyright {
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            color: #ddd;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: #b7b7b7;
            padding: 2rem;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal h3 {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .modal p {
            margin-bottom: 2rem;
        }

        .close-modal {
            background-color: var(--secondary);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }

        .close-modal:hover {
            background-color: #2980b9;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            nav ul {
                margin-top: 1rem;
                justify-content: center;
            }

            nav ul li {
                margin: 0 0.5rem;
            }

            .hero-content h1 {
                font-size: 2.2rem;
            }

            .hero-content p {
                font-size: 1rem;
            }

            .btn {
                display: block;
                width: 80%;
                margin: 0 auto 1rem;
            }

            .btn-outline {
                margin-left: 0;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }


        .service-icon {
            height: 72px;
        }

        .map-iframe {
            width: 100%;
            height: 500px;
            border: 0;
            border-radius: 14px;
        }

        .route-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin: 2rem 0;
            animation: fadeInUp 1s ease 0.4s both;
        }

        .location {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .location img {
            height: 52px;
        }

        #terminos {
            margin-top: 1rem;
            display: inline-flex;
            flex-direction: row;
            gap: 7px;
        }

        #termsCheckbox {
            width: 20px;
            cursor: pointer;
        }

        #googleSignInBtn {
    transition: all 0.3s ease;
    border: none;
    padding: 0.8rem 1.5rem;
    font-weight: 500;
}

#googleSignInBtn:hover {
    background-color: #3367D6 !important;
    box-shadow: 0 5px 15px rgba(66, 133, 244, 0.4);
}

.fa-spinner {
    margin-right: 8px;
}

    </style>
</head>

<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo">Mee<span>Transportation</span></a>
                <nav>
                    <ul>
                        <li><a href="#inicio" data-i18n="inicio">Inicio</a></li>
                        <li><a href="#services" data-i18n="servicios">Servicios</a></li>
                        <li><a href="#quote" data-i18n="cotizacion">Cotizaci√≥n</a></li>
                        <li><a href="#tracking" data-i18n="rastreo">Rastreo</a></li>
                        <li><a href="#contact" data-i18n="contacto">Contacto</a></li>
                        <li><a href="#" id="loginBtn" data-i18n="login">Iniciar Sesi√≥n</a></li>
                        <li><a href="#" id="userProfile" style="display: none;font-size: 21px;color: #5cc528;font-weight:600;"></a></li>
                        <li style="margin-left: 0rem;"><a href="#" id="logoutBtn" style="display:none;" class="btn btn-outline">Cerrar Sesi√≥n</a></li>
                        <li>
                            <select id="languageSelector" style="cursor: pointer;background: var(--primary); color: white; border: 1px solid white; border-radius: 5px; padding: 2px 5px;">
                                <option value="es">üá©üá¥ Espa√±ol</option>
                                <option value="en">üá∫üá∏ English</option>
                            </select>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="inicio">
        <div class="container">
            <div class="route-info">
                <div class="location">
                    <img src="./img/Bandera_USA_1.png">
                    <h3 style="margin: 0px 31px;" data-i18n="EstadosUnidos">Estados Unidos</h3>
                    <p data-i18n="NY">Nueva York, NY</p>
                </div>
                <div class="arrow">
                    <i class="fas fa-arrow-right" style="font-size: 40px;color: #ffffff;"></i>
                </div>
                <div class="location">
                    <img src="./img/Bandera_RD_1.png">
                    <h3 data-i18n="RD">Rep√∫blica Dominicana</h3>
                    <p data-i18n="TodoPais">Todo el pa√≠s</p>
                </div>
            </div>

            <div class="hero-content">
                <h1 data-i18n="heroTitle">Env√≠os seguros de USA a Rep√∫blica Dominicana</h1>
                <p data-i18n="heroText">Especializados en el env√≠o de tanques azules y cajas desde Nueva York a todo el territorio dominicano. Confiabilidad, rapidez y transparencia en cada env√≠o.</p>
                <a href="#quote" class="btn" data-i18n="quoteBtn">Solicitar Cotizaci√≥n</a>
                <a href="#services" class="btn btn-outline" data-i18n="servicesBtn">Nuestros Servicios</a>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services">
        <div class="container">
            <h2 class="section-title">Nuestros Servicios</h2>
            <div class="services-grid">
                <!-- Cajas -->
                <div class="service-card">
                    <div class="service-icon"><img src="./img/caja_icon_1.png"></div>
                    <div class="service-title">Caja Grande</div>
                    <div class="service-price">US$80</div>
                    <ul class="service-details">
                        <li><strong>Dimensiones:</strong> 18" x 18" x 28"</li>
                        <li><strong>Capacidad m√°xima:</strong> 65 lbs</li>
                        <li><strong>Contenido:</strong> Solo comida y ropa usada</li>
                        <li><strong>Nota:</strong> Si excede la capacidad, el precio puede variar</li>
                    </ul>
                </div>

                <!-- Tanque 55 Galones -->
                <div class="service-card">
                    <div class="service-icon"><img src="./img/tanque_icon_1.png"></div>
                    <div class="service-title">Tanque 55 Galones</div>
                    <div class="service-price">US$125</div>
                    <ul class="service-details">
                        <li><strong>Capacidad:</strong> 55 galones</li>
                        <li><strong>Ideal para:</strong> Alimentos, ropa, art√≠culos de higiene, productos de limpieza y m√°s.</li>
                        <li><strong>Material:</strong> Resistente y seguro</li>
                        <li><strong>Entrega:</strong> A domicilio en RD</li>
                    </ul>
                </div>

                <!-- Tanque 77 Galones -->
                <div class="service-card">
                    <div class="service-icon"><img src="./img/tanque_icon_1.png"></div>
                    <div class="service-title">Tanque 77 Galones</div>
                    <div class="service-price">US$140</div>
                    <ul class="service-details">
                        <li><strong>Capacidad:</strong> 77 galones</li>
                        <li><strong>Ideal para:</strong> Alimentos, ropa, art√≠culos de higiene, productos de limpieza y m√°s.</li>
                        <li><strong>Material:</strong> Resistente y seguro</li>
                        <li><strong>Entrega:</strong> A domicilio en RD</li>
                    </ul>
                </div>

                <!-- Oferta Especial -->
                <div class="service-card offer-card">
                    <div class="service-title">
                        <i class="fas fa-gift"></i> Oferta Especial
                    </div>
                    <div class="service-price">3 Cajas por US$200</div>
                    <ul class="service-details">
                        <li><strong>Condici√≥n:</strong> Misma direcci√≥n y receptor</li>
                        <li><strong>Restricciones:</strong> Depende de provincia/ciudad</li>
                        <li><strong>Ahorro:</strong> US$40 en total</li>
                        <li><strong>Perfecto para:</strong> Familias grandes</li>
                    </ul>
                </div>

                <!-- Arroz y Aceite -->
                <div class="service-card">
                    <div class="service-title">
                        <i class="fas fa-seedling"></i> Arroz y Aceite
                    </div>
                    <div class="service-price">¬°GRATIS!</div>
                    <ul class="service-details">
                        <li><strong>1 Saco de Arroz:</strong> 20-25 lbs (Gratis con env√≠o)</li>
                        <li><strong>1 Gal√≥n de Aceite:</strong> Gratis con env√≠o</li>
                        <li><strong>Arroz 50 lbs:</strong> +US$5</li>
                        <li><strong>Aceite 2.5 Gls:</strong> +US$5</li>
                    </ul>
                </div>

                <!-- Promoci√≥n 100 Primeros -->
                <div class="service-card offer-card">
                    <div class="service-title">
                        <i class="fas fa-star"></i> Promoci√≥n Especial
                    </div>
                    <div class="service-price">¬°100 PRIMEROS!</div>
                    <ul class="service-details">
                        <li><strong>1 Gal√≥n de Aceite:</strong> GRATIS</li>
                        <li><strong>1 Saco de Arroz 20 lbs:</strong> GRATIS</li>
                        <li><strong>Solo:</strong> Los primeros 100 env√≠os</li>
                        <li><strong>¬°Reg√≠strate ahora!</strong></li>
                    </ul>
                </div>
            </div>

            <div style="text-align: center; margin-top: 2rem; padding: 2rem; background: linear-gradient(135deg, #ffeaa7, #fab1a0); border-radius: 15px;">
                <h3 style="color: #2d3436; margin-bottom: 1rem;">
                    <i class="fas fa-shopping-cart"></i> ¬øNo tienes arroz o aceite?
                </h3>
                <p style="font-size: 1.2rem; color: #2d3436;">
                    ¬°No te preocupes! Nosotros te lo vendemos al mejor precio.
                </p>
            </div>
        </div>
    </section>

    <!-- Quote Section -->
    <section id="quote" class="quote">
        <div class="container">
            <div class="section-title" style="margin-bottom: 1rem;">
                <h2 style="color: white;">Solicita tu Cotizaci√≥n</h2>
            </div>
            <div class="quote-form">
                <form id="quoteForm">
                    <div class="form-group">
                        <label for="name">Nombre Completo</label>
                        <input type="text" id="name" class="form-control" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Correo Electr√≥nico</label>
                            <input type="email" id="email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Tel√©fono</label>
                            <input type="tel" id="phone" class="form-control" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Tipo de Paquete</label>
                        <div class="package-type">
                            <div class="package-option">
                                <input type="radio" id="box" name="package" value="Caja Grande" checked>
                                <label for="box">Caja Grande</label>
                            </div>
                            <div class="package-option">
                                <input type="radio" id="tank55" name="package" value="Tanque 55 Galones">
                                <label for="tank55">Tanque 55 Gal</label>
                            </div>
                            <div class="package-option">
                                <input type="radio" id="tank77" name="package" value="Tanque 77 Galones">
                                <label for="tank77">Tanque 77 Gal</label>
                            </div>
                            <div class="package-option">
                                <input type="radio" id="commonItem" name="package" value="Art√≠culo Com√∫n">
                                <label for="commonItem" style="padding: 1rem 0px;">Art√≠culo Com√∫n</label>
                            </div>
                            <div class="package-option">
                                <input type="radio" id="custom" name="package" value="Personalizado">
                                <label for="custom">Personalizado</label>
                            </div>
                        </div>
                    </div>

                    <div id="commonItemDiv" class="custom-package">
                        <div class="form-group">
                            <label for="commonItemType">Seleccione el art√≠culo</label>
                            <select id="commonItemType" class="form-control">
                                <option value="">Seleccione un art√≠culo</option>
                                <option value="Cama (Queen/King)">Cama (Queen/King) - 80" x 60" x 12"</option>
                                <option value="Nevera est√°ndar">Nevera est√°ndar - 70" x 36" x 30"</option>
                                <option value="TV 55-65 pulgadas">TV 55-65" - 60" x 40" x 10"</option>
                                <option value="Sof√° 3 plazas">Sof√° 3 plazas - 84" x 36" x 36"</option>
                                <option value="Mesa comedor">Mesa comedor - 72" x 40" x 30"</option>
                                <option value="Bicicleta">Bicicleta - 70" x 30" x 10"</option>
                                <option value="Equipo de gimnasio">Equipo de gimnasio - Var√≠a seg√∫n equipo</option>
                                <option value="Generador el√©ctrico">Generador el√©ctrico - 30" x 20" x 20"</option>
                                <option value="Aire acondicionado">Aire acondicionado - 36" x 24" x 24"</option>
                                <option value="Lavadora">Lavadora - 42" x 28" x 30"</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="commonItemWeight">Peso estimado (lbs)</label>
                            <input type="number" id="commonItemWeight" class="form-control" min="1">
                        </div>
                    </div>

                    <div id="customPackage" class="custom-package">
                        <div class="form-group">
                            <label for="item">Art√≠culo a enviar</label>
                            <input type="text" id="item" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="commercialValue">Valor comercial (USD)</label>
                            <input type="number" id="commercialValue" class="form-control" min="0" step="0.01">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="length">Largo (pulgadas)</label>
                                <input type="number" id="length" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="width">Ancho (pulgadas)</label>
                                <input type="number" id="width" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="height">Alto (pulgadas)</label>
                                <input type="number" id="height" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="weight">Peso (lbs)</label>
                                <input type="number" id="weight" class="form-control" min="1">
                            </div>
                        </div>
                    </div>

                    <div class="additional-items">
                        <h4>Art√≠culos adicionales (opcional)</h4>
                        <div class="checkbox-group">
                            <input type="checkbox" id="rice20" name="additional" value="Saco de arroz 20-25 lbs (Gratis)">
                            <label for="rice20">Saco de arroz 20-25 lbs (Gratis)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="rice50" name="additional" value="Saco de arroz 50 lbs (+US$5)">
                            <label for="rice50">Saco de arroz 50 lbs (+US$5)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="oil1" name="additional" value="1 Gal√≥n de aceite (Gratis)">
                            <label for="oil1">1 Gal√≥n de aceite (Gratis)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="oil25" name="additional" value="2.5 Galones de aceite (+US$5)">
                            <label for="oil25">2.5 Galones de aceite (+US$5)</label>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="origin">Origen (Ciudad, Estado)</label>
                            <input type="text" id="origin" class="form-control" value="New York, NY" required>
                        </div>
                        <div class="form-group">
                            <label for="destination">Destino (Ciudad, Provincia)</label>
                            <input type="text" id="destination" class="form-control" placeholder="Ej: Santo Domingo, Distrito Nacional" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="message">Mensaje adicional (opcional)</label>
                        <textarea id="message" class="form-control" rows="4"></textarea>
                    </div>

                    <button type="submit" class="btn">Enviar Solicitud</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact">
        <div class="container">
            <div class="section-title" style="margin-bottom: 1rem;">
                <h2>Contacto</h2>
            </div>
            <div class="contact-content" style="margin-bottom: 1rem;">
                <p>¬øTienes alguna pregunta? No dudes en contactarnos. Estamos aqu√≠ para ayudarte con tus necesidades de env√≠o.</p>
                <div class="contact-info">
                    <p><i class="fas fa-phone"></i> (123) 456-7890</p>
                    <p><i class="fas fa-envelope"></i> info@meetransportation.com</p>
                    <p><i class="fas fa-map-marker-alt"></i> Nueva York, USA</p>
                </div>
            </div>

            <!-- Start Map -->
            <iframe class="map-iframe" src="https://maps.google.com/maps?q=40.83005838598232, -73.94384101203005&t=&z=15&ie=UTF8&iwloc=&output=embed" allowfullscreen="" loading="lazy"></iframe>
            <!-- End Map -->
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Meetransportation</h3>
                    <p>Especialistas en env√≠os desde Estados Unidos a Rep√∫blica Dominicana. Confiabilidad y rapidez en cada entrega.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Enlaces R√°pidos</h3>
                    <a href="#services">Servicios</a>
                    <a href="#quote">Cotizaci√≥n</a>
                    <a href="#">Rastreo</a>
                    <a href="#contact">Contacto</a>
                </div>
                <div class="footer-column">
                    <h3>Horario</h3>
                    <p>Lunes - Viernes: 9am - 6pm</p>
                    <p>S√°bado: 9am - 2pm</p>
                    <p>Domingo: Cerrado</p>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 Meetransportation. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Modal -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <h3>¬°Solicitud Enviada!</h3>
            <p>Hemos recibido tu solicitud de cotizaci√≥n. Nos pondremos en contacto contigo en las pr√≥ximas 24 horas con los detalles de tu env√≠o.</p>
            <button class="close-modal btn">Cerrar</button>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3>Iniciar Sesi√≥n / Registrarse</h3>
            <form id="authForm">
                <div class="form-group">
                    <label for="authEmail">Correo Electr√≥nico</label>
                    <input type="email" id="authEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="authPassword">Contrase√±a</label>
                    <input type="password" id="authPassword" class="form-control" required>
                </div>

                <!-- Campos adicionales para registro -->
                <div id="registerFields" style="display: none;">
                    <div class="form-group">
                        <label for="fullName">Nombre Completo</label>
                        <input type="text" id="fullName" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="phoneNumber">N√∫mero de Tel√©fono</label>
                        <input type="tel" id="phoneNumber" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="address">Direcci√≥n</label>
                        <input type="text" id="address" class="form-control">
                    </div>
                    <div class="form-group" id="terminos">
                        <input type="checkbox" id="termsCheckbox" required>
                        <label for="termsCheckbox" style="margin-bottom: 0rem;">Acepto los <a href="#" style="color: var(--secondary);" onclick="showTerms()">T√©rminos y Condiciones</a></label>
                    </div>
                </div>

                <button type="button" id="loginUserBtn" class="btn">Iniciar Sesi√≥n</button>
                <button type="button" id="registerUserBtn" class="btn btn-outline">Registrarse</button>
                <button type="button" id="showLoginBtn" class="btn btn-outline" style="display: none;">Ya tengo cuenta</button>
                
                <!-- Bot√≥n de Google -->
                <div style="text-align: center; margin: 1rem 0;">
                    <p style="margin: 1rem 0;">O inicia sesi√≥n con</p>
                    <button type="button" id="googleSignInBtn" class="btn" style="background-color: #4285F4; color: white; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" style="width: 20px; height: 20px; margin-right: 10px; background: white; padding: 5px; border-radius: 50%;">
                        Google
                    </button>
                </div>
                
                <div id="authMessage" style="margin-top: 1rem; color: var(--accent);"></div>
            </form>
        </div>
    </div>

    <!-- T√©rminos y Condiciones Modal -->
    <div id="termsModal" class="modal">
        <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
            <h3>T√©rminos y Condiciones</h3>
            <div style="text-align: left; margin-bottom: 1.5rem;">
                <p><strong>√öltima actualizaci√≥n:</strong> 26 de junio de 2025</p>
                <h4>1. Aceptaci√≥n de los T√©rminos</h4>
                <p>Al registrarte en Meetransportation, aceptas cumplir con estos t√©rminos y condiciones.</p>
                <h4>2. Servicios</h4>
                <p>Meetransportation ofrece servicios de env√≠o de paquetes desde Estados Unidos a Rep√∫blica Dominicana.</p>
                <h4>3. Responsabilidades del Usuario</h4>
                <p>El usuario es responsable de proporcionar informaci√≥n precisa y completa durante el registro y al solicitar servicios.</p>
                <h4>4. Privacidad</h4>
                <p>Tus datos personales ser√°n protegidos seg√∫n nuestra Pol√≠tica de Privacidad.</p>
                <h4>5. Restricciones</h4>
                <p>No se permiten env√≠os de art√≠culos ilegales o prohibidos por las leyes de tr√°nsito internacional.</p>
                <h4>6. Modificaciones</h4>
                <p>Nos reservamos el derecho de modificar estos t√©rminos en cualquier momento.</p>
                <h4>7. Limitaci√≥n de Responsabilidad</h4>
                <p>Meetransportation no ser√° responsable por da√±os indirectos o consecuenciales derivados del uso del servicio.</p>
            </div>
            <button class="close-terms-modal btn">Aceptar</button>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <h3>Mi Perfil</h3>
            <div id="userInfo"></div>
            <h4 style="margin-top: 1.5rem;">Mis Env√≠os</h4>
            <div id="userShipments" style="max-height: 300px; overflow-y: auto;"></div>
            <button class="close-modal btn" style="margin-top: 1.5rem;">Cerrar</button>
        </div>
    </div>

    <script>
        // Firebase Configuration
const firebaseConfig = {
    apiKey: "AIzaSyDUPUM36QOLPGb-FmPx6-qMZoS2pCZdurI",
    authDomain: "meetransportation.firebaseapp.com",
    projectId: "meetransportation",
    storageBucket: "meetransportation.firebasestorage.app",
    messagingSenderId: "1087042032724",
    appId: "1:1087042032724:web:0975e57ca30ff342f349c1",
    measurementId: "G-8XHXKXL0CV"
};

// Inicializa Firebase
const app = firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Proveedor Google
const googleProvider = new firebase.auth.GoogleAuthProvider();
googleProvider.setCustomParameters({ prompt: 'select_account' });

        // Translations
        const translations = {
            es: {
                "inicio": "Inicio",
                "servicios": "Servicios",
                "cotizacion": "Cotizaci√≥n",
                "contacto": "Contacto",
                "login": "Iniciar Sesi√≥n",
                "logout": "Cerrar Sesi√≥n",
                "heroTitle": "Env√≠os seguros de USA a Rep√∫blica Dominicana",
                "heroText": "Especializados en el env√≠o de tanques azules y cajas desde Nueva York a todo el territorio dominicano. Confiabilidad, rapidez y transparencia en cada env√≠o.",
                "quoteBtn": "Solicitar Cotizaci√≥n",
                "servicesBtn": "Nuestros Servicios",
                "EstadosUnidos": "Estados Unidos",
                "RD": "Rep√∫blica Dominicana",
                "NY": "Nueva York, NY",
                "TodoPais": "Todo el pa√≠s",
                "rastreo": "Rastreo",
            },
            en: {
                "inicio": "Home",
                "servicios": "Services",
                "cotizacion": "Quote",
                "contacto": "Contact",
                "login": "Login",
                "logout": "Logout",
                "heroTitle": "Secure shipping from USA to Dominican Republic",
                "heroText": "Specialized in shipping blue tanks and boxes from New York to all Dominican territory. Reliability, speed and transparency in every shipment.",
                "quoteBtn": "Request Quote",
                "EstadosUnidos": "United States",
                "RD": "Dominican Republic",
                "NY": "New York, NY",
                "TodoPais": "The whole country",
                "rastreo": "Tracking",
            }
        };

        let currentLanguage = 'es'; // Default language

        function changeLanguage(lang) {
            currentLanguage = lang;
            document.getElementById('languageSelector').value = lang;

            // Update texts
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });

            // Save language preference
            localStorage.setItem('preferredLanguage', lang);
        }

        // Global variables
        let currentUser = null;

        // DOM Elements
        const quoteForm = document.getElementById('quoteForm');
        const successModal = document.getElementById('successModal');
        const loginModal = document.getElementById('loginModal');
        const profileModal = document.getElementById('profileModal');
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const userProfile = document.getElementById('userProfile');
        const customPackageDiv = document.getElementById('customPackage');
        const commonItemDiv = document.getElementById('commonItemDiv');

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function () {
            // Hide registration fields by default
            document.getElementById('registerFields').style.display = 'none';
            document.getElementById('showLoginBtn').style.display = 'none';

            // Package type change listener
            const packageOptions = document.querySelectorAll('input[name="package"]');
            packageOptions.forEach(option => {
                option.addEventListener('change', function () {
                    customPackageDiv.classList.remove('show');
                    commonItemDiv.classList.remove('show');

                    if (this.value === 'Personalizado') {
                        customPackageDiv.classList.add('show');
                    } else if (this.value === 'Art√≠culo Com√∫n') {
                        commonItemDiv.classList.add('show');
                    }
                });
            });

            // Quote form submission
            quoteForm.addEventListener('submit', handleQuoteSubmission);

            // Modal listeners
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', closeModals);
            });

            document.querySelector('.close-terms-modal')?.addEventListener('click', function () {
                document.getElementById('termsModal').style.display = 'none';
                if (document.getElementById('registerFields').style.display === 'block') {
                    document.getElementById('loginModal').style.display = 'flex';
                }
            });

            // Authentication listeners
            loginBtn.addEventListener('click', () => showModal(loginModal));
            logoutBtn.addEventListener('click', logout);
            userProfile.addEventListener('click', () => showModal(profileModal));

            document.getElementById('loginUserBtn').addEventListener('click', loginUser);
            document.getElementById('registerUserBtn').addEventListener('click', registerUser);
            document.getElementById('showLoginBtn').addEventListener('click', showLoginForm);
            
            // Google Sign-In Button
            document.getElementById('googleSignInBtn').addEventListener('click', signInWithGoogle);

            // Close modal when clicking outside
            window.addEventListener('click', function (e) {
                if (e.target.classList.contains('modal')) {
                    closeModals();
                }
            });

            // Smooth scrolling for internal links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();

                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;

                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // Language selector
            document.getElementById('languageSelector').addEventListener('change', (e) => {
                changeLanguage(e.target.value);
            });

            // Load saved language or detect browser language
            const savedLanguage = localStorage.getItem('preferredLanguage');
            const browserLanguage = navigator.language.split('-')[0];
            const initialLanguage = savedLanguage || (browserLanguage === 'es' ? 'es' : 'en');
            changeLanguage(initialLanguage);

            // Check authentication state
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    updateUIForLoggedInUser(user);
                } else {
                    currentUser = null;
                    updateUIForLoggedOutUser();
                }
            });
        });

        // Sign in with Google
async function signInWithGoogle() {
    const messageDiv = document.getElementById('authMessage');
    const googleBtn = document.getElementById('googleSignInBtn');
    const originalText = googleBtn.innerHTML; // Define originalText aqu√≠
    
    try {
        googleBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Iniciando sesi√≥n...';
        googleBtn.disabled = true;
        
        const result = await firebase.auth().signInWithPopup(googleProvider);
                const user = result.user;
                
                // Check if new user
                if (result.additionalUserInfo?.isNewUser) {
                    // Create user profile in Firestore
                    await db.collection('users').doc(user.uid).set({
                        email: user.email,
                        registrationDate: firebase.firestore.FieldValue.serverTimestamp(),
                        profile: {
                            name: user.displayName || user.email.split('@')[0],
                            phone: user.phoneNumber || '',
                            photoURL: user.photoURL || ''
                        },
                        termsAccepted: true,
                        termsAcceptanceDate: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                
                // Show success message
                messageDiv.style.color = 'var(--success)';
                messageDiv.textContent = 'Inicio de sesi√≥n con Google exitoso!';
                
                // Close modal after short delay
                setTimeout(() => {
                    closeModals();
                }, 1500);
                
    } catch (error) {
        console.error('Error en autenticaci√≥n con Google:', error);
        messageDiv.textContent = getAuthErrorMessage(error.code);
    } finally {
        if (googleBtn) {
            googleBtn.innerHTML = originalText; // Ahora originalText est√° definido
            googleBtn.disabled = false;
        }
    }
}

        // Handle quote form submission
        async function handleQuoteSubmission(e) {
            e.preventDefault();

            // Show loading indicator
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Sending...';
            submitBtn.disabled = true;

            try {
                // Collect form data
                const formData = collectFormData();

                // Validate data
                if (!validateFormData(formData)) {
                    throw new Error('Please fill all required fields');
                }

                // Save to Firestore
                const docRef = await db.collection('quotes').add({
                    ...formData,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    status: 'pending',
                    userId: currentUser ? currentUser.uid : null,
                    userEmail: currentUser ? currentUser.email : formData.email
                });

                console.log('Quote saved with ID: ', docRef.id);

                // Reset form
                quoteForm.reset();
                customPackageDiv.classList.remove('show');

                // Show success modal
                showModal(successModal);

                // Update user profile if logged in
                if (currentUser) {
                    await updateUserProfile(formData);
                }

            } catch (error) {
                console.error('Error submitting quote:', error);
                alert('Error submitting quote: ' + error.message);
            } finally {
                // Restore button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        }

        // Collect form data
        function collectFormData() {
            const packageType = document.querySelector('input[name="package"]:checked').value;

            // Basic data
            const formData = {
                name: document.getElementById('name').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                packageType: packageType,
                origin: document.getElementById('origin').value.trim(),
                destination: document.getElementById('destination').value.trim(),
                message: document.getElementById('message').value.trim()
            };

            // If it's a common item
            if (packageType === 'Art√≠culo Com√∫n') {
                formData.commonItem = {
                    type: document.getElementById('commonItemType').value,
                    weight: parseInt(document.getElementById('commonItemWeight').value) || 0
                };
            }
            // If it's a custom package
            else if (packageType === 'Personalizado') {
                formData.customItem = {
                    item: document.getElementById('item').value.trim(),
                    commercialValue: parseFloat(document.getElementById('commercialValue').value) || 0,
                    length: parseInt(document.getElementById('length').value) || 0,
                    width: parseInt(document.getElementById('width').value) || 0,
                    height: parseInt(document.getElementById('height').value) || 0,
                    weight: parseInt(document.getElementById('weight').value) || 0
                };
            }

            // Collect additional items
            const additionalItems = [];
            document.querySelectorAll('input[name="additional"]:checked').forEach(checkbox => {
                additionalItems.push(checkbox.value);
            });
            formData.additionalItems = additionalItems;

            // Calculate estimated price
            formData.estimatedPrice = calculateEstimatedPrice(packageType, additionalItems);

            return formData;
        }

        // Validate form data
        function validateFormData(data) {
            const required = ['name', 'email', 'phone', 'packageType', 'origin', 'destination'];

            for (let field of required) {
                if (!data[field] || data[field].length === 0) {
                    return false;
                }
            }

            // Validate email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(data.email)) {
                return false;
            }

            // Validate common item
            if (data.packageType === 'Art√≠culo Com√∫n') {
                if (!data.commonItem?.type || data.commonItem.weight <= 0) {
                    return false;
                }
            }
            // Validate custom package
            else if (data.packageType === 'Personalizado') {
                if (!data.customItem?.item ||
                    data.customItem.length <= 0 ||
                    data.customItem.width <= 0 ||
                    data.customItem.height <= 0 ||
                    data.customItem.weight <= 0) {
                    return false;
                }
            }

            return true;
        }

        // Calculate estimated price
        function calculateEstimatedPrice(packageType, additionalItems) {
            let basePrice = 0;

            switch (packageType) {
                case 'Caja Grande':
                    basePrice = 80;
                    break;
                case 'Tanque 55 Galones':
                    basePrice = 125;
                    break;
                case 'Tanque 77 Galones':
                    basePrice = 140;
                    break;
                case 'Personalizado':
                    basePrice = 0; // Will be calculated later
                    break;
            }

            // Add additional items cost
            let additionalCost = 0;
            additionalItems.forEach(item => {
                if (item.includes('+US$5')) {
                    additionalCost += 5;
                }
            });

            return basePrice + additionalCost;
        }

        // Show terms and conditions
        function showTerms() {
            document.getElementById('termsModal').style.display = 'flex';
        }

        // Show login form
        function showLoginForm() {
            document.getElementById('registerFields').style.display = 'none';
            document.getElementById('loginUserBtn').style.display = 'inline-block';
            document.getElementById('registerUserBtn').textContent = 'Register';
            document.getElementById('showLoginBtn').style.display = 'none';

            // Clear error messages
            const messageDiv = document.getElementById('authMessage');
            if (messageDiv) {
                messageDiv.textContent = '';
            }
        }

        // Login user
        async function loginUser() {
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            const messageDiv = document.getElementById('authMessage');

            if (!email || !password) {
                messageDiv.textContent = 'Please enter email and password';
                return;
            }

            try {
                // Show loading indicator
                const loginBtn = document.getElementById('loginUserBtn');
                const originalText = loginBtn.textContent;
                loginBtn.textContent = 'Logging in...';
                loginBtn.disabled = true;

                await auth.signInWithEmailAndPassword(email, password);
                messageDiv.style.color = 'var(--success)';
                messageDiv.textContent = 'Login successful!';

                // Close modal after short delay
                setTimeout(() => {
                    closeModals();
                }, 1500);
            } catch (error) {
                messageDiv.textContent = getAuthErrorMessage(error.code);
                console.error('Login error:', error);
            } finally {
                // Restore button
                const loginBtn = document.getElementById('loginUserBtn');
                if (loginBtn) {
                    loginBtn.textContent = originalText;
                    loginBtn.disabled = false;
                }
            }
        }

        // Register user
        async function registerUser() {
            const registerFields = document.getElementById('registerFields');
            const showLoginBtn = document.getElementById('showLoginBtn');
            const loginBtn = document.getElementById('loginUserBtn');
            const registerBtn = this;

            // If registration fields are hidden, show them first
            if (registerFields.style.display === 'none' || !registerFields.style.display) {
                registerFields.style.display = 'block';
                loginBtn.style.display = 'none';
                registerBtn.textContent = 'Complete Registration';
                showLoginBtn.style.display = 'inline-block';
                return; // Exit without trying to register
            }

            // Proceed with registration if fields are visible
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            const fullName = document.getElementById('fullName').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const address = document.getElementById('address').value;
            const termsChecked = document.getElementById('termsCheckbox').checked;
            const messageDiv = document.getElementById('authMessage');

            // Validations
            if (!email || !password || !fullName || !phoneNumber || !address) {
                messageDiv.textContent = 'Please complete all fields';
                return;
            }

            if (!termsChecked) {
                messageDiv.textContent = 'You must accept the terms and conditions';
                return;
            }

            if (password.length < 6) {
                messageDiv.textContent = 'Password must be at least 6 characters';
                return;
            }

            try {
                // Show loading indicator
                const originalText = registerBtn.textContent;
                registerBtn.textContent = 'Registering...';
                registerBtn.disabled = true;

                // Create user
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);

                // Create user document
                await db.collection('users').doc(userCredential.user.uid).set({
                    email: email,
                    registrationDate: firebase.firestore.FieldValue.serverTimestamp(),
                    profile: {
                        name: fullName,
                        phone: phoneNumber,
                        address: address
                    },
                    termsAccepted: true,
                    termsAcceptanceDate: firebase.firestore.FieldValue.serverTimestamp()
                });

                // Show success message
                messageDiv.style.color = 'var(--success)';
                messageDiv.textContent = 'Registration successful! Logging in...';

                // Close modal after short delay
                setTimeout(() => {
                    closeModals();
                }, 1500);

            } catch (error) {
                messageDiv.textContent = getAuthErrorMessage(error.code);
                console.error('Registration error:', error);
            } finally {
                // Restore button
                registerBtn.textContent = originalText;
                registerBtn.disabled = false;
            }
        }

        // Logout
        async function logout() {
            try {
                await auth.signOut();
            } catch (error) {
                console.error('Logout error:', error);
                alert('Logout error: ' + error.message);
            }
        }

        // Update user profile
        async function updateUserProfile(formData) {
            if (!currentUser) return;

            try {
                await db.collection('users').doc(currentUser.uid).update({
                    'profile.name': formData.name,
                    'profile.phone': formData.phone,
                    lastActivity: firebase.firestore.FieldValue.serverTimestamp()
                });
            } catch (error) {
                console.error('Error updating profile:', error);
            }
        }

        // UI Functions
        function updateUIForLoggedInUser(user) {
            loginBtn.style.display = 'none';
            userProfile.style.display = 'inline-block';
            logoutBtn.style.display = 'inline-block';

            // Get user data
            db.collection('users').doc(user.uid).get().then(doc => {
                if (doc.exists) {
                    const userData = doc.data();
                    const fullName = userData.profile?.name || user.email;
                    const firstName = fullName.split(' ')[0];
                    
                    // If user has Google photo, show it
                    if (user.photoURL) {
                        userProfile.innerHTML = `<img src="${user.photoURL}" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 5px; vertical-align: middle;"> ${firstName}`;
                    } else {
                        userProfile.textContent = firstName;
                    }
                } else {
                    // If no data in Firestore but user has Google photo
                    if (user.photoURL) {
                        userProfile.innerHTML = `<img src="${user.photoURL}" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 5px; vertical-align: middle;"> ${user.email.split('@')[0]}`;
                    } else {
                        userProfile.textContent = user.email.split('@')[0];
                    }
                }
            }).catch(error => {
                console.error("Error getting user data:", error);
                userProfile.textContent = user.email.split('@')[0];
            });
        }

        function updateUIForLoggedOutUser() {
            loginBtn.style.display = 'inline-block';
            userProfile.style.display = 'none';
            logoutBtn.style.display = 'none';
        }

        async function loadUserProfile(userId) {
            try {
                const userDoc = await db.collection('users').doc(userId).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    const firstName = userData.profile?.name?.split(' ')[0] || currentUser.email.split('@')[0];

                    document.getElementById('userInfo').innerHTML = `
                    <p><strong>Email:</strong> ${currentUser.email}</p>
                    <p><strong>Name:</strong> ${userData.profile?.name || 'Not specified'}</p>
                    <p><strong>Phone:</strong> ${userData.profile?.phone || 'Not specified'}</p>
                    <p><strong>Member since:</strong> ${userData.registrationDate?.toDate().toLocaleDateString() || 'N/A'}</p>
                `;
                }

                // Load user shipments
                loadUserShipments(userId);
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        async function loadUserShipments(userId) {
            try {
                const shipmentsQuery = await db.collection('quotes')
                    .where('userId', '==', userId)
                    .orderBy('timestamp', 'desc')
                    .limit(10)
                    .get();

                const shipmentsDiv = document.getElementById('userShipments');

                if (shipmentsQuery.empty) {
                    shipmentsDiv.innerHTML = '<p>No shipments registered</p>';
                    return;
                }

                let shipmentsHTML = '';
                shipmentsQuery.forEach(doc => {
                    const shipment = doc.data();
                    const date = shipment.timestamp?.toDate().toLocaleDateString() || 'N/A';
                    shipmentsHTML += `
                    <div style="border: 1px solid #ddd; padding: 1rem; margin-bottom: 1rem; border-radius: 5px;">
                        <p><strong>Type:</strong> ${shipment.packageType}</p>
                        <p><strong>Destination:</strong> ${shipment.destination}</p>
                        <p><strong>Date:</strong> ${date}</p>
                        <p><strong>Status:</strong> <span style="color: var(--secondary);">${shipment.status}</span></p>
                        <p><strong>Estimated price:</strong> $${shipment.estimatedPrice}</p>
                    </div>
                `;
                });

                shipmentsDiv.innerHTML = shipmentsHTML;
            } catch (error) {
                console.error('Error loading shipments:', error);
                document.getElementById('userShipments').innerHTML = '<p>Error loading shipments</p>';
            }
        }

        // Utility Functions
        function showModal(modal) {
            modal.style.display = 'flex';
            // Clear previous error messages
            const authMessage = document.getElementById('authMessage');
            if (authMessage) {
                authMessage.textContent = '';
                authMessage.style.color = 'var(--accent)';
            }
        }

        function closeModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });

            // Reset forms
            const authForm = document.getElementById('authForm');
            if (authForm) {
                authForm.reset();
                document.getElementById('registerFields').style.display = 'none';
                document.getElementById('loginUserBtn').style.display = 'inline-block';
                document.getElementById('registerUserBtn').textContent = 'Register';
                document.getElementById('showLoginBtn').style.display = 'none';
            }
        }

        function getAuthErrorMessage(errorCode) {
            switch (errorCode) {
                case 'auth/user-not-found':
                    return 'User not found';
                case 'auth/wrong-password':
                    return 'Incorrect password';
                case 'auth/email-already-in-use':
                    return 'This email is already registered';
                case 'auth/weak-password':
                    return 'Password is too weak (minimum 6 characters)';
                case 'auth/invalid-email':
                    return 'Invalid email';
                case 'auth/too-many-requests':
                    return 'Too many attempts. Please try again later';
                default:
                    return 'Authentication error. Please try again';
            }
        }
    </script>
</body>
</html>
